// =============================================================================
// UNNAMED UI - Select Component Styles
// =============================================================================

@use '../../../style/themes' as *;
@use '../../../style/mixins' as *;

$select-prefix-cls: nx-select;

// =============================================================================
// SELECT COMPONENT BASE
// =============================================================================

.#{$select-prefix-cls} {
    @include select-base($select-prefix-cls);

    // Add explicit height like input fields
    height: $select-height-base;

    // Size variants
    &-small {
        @include select-small($select-prefix-cls);
        height: $select-height-sm;
    }

    &-large {
        @include select-large($select-prefix-cls);
        height: $select-height-lg;
    }

    // State variants
    &-disabled {
        @include select-disabled($select-prefix-cls);
    }

    &-loading {
        @include select-loading($select-prefix-cls);
    }

    // Style variants
    &-outlined {
        @include select-outlined($select-prefix-cls);
    }

    &-filled {
        @include select-filled($select-prefix-cls);
    }

    &-borderless {
        @include select-borderless($select-prefix-cls);
    }
}

// =============================================================================
// SELECT SELECTOR (TRIGGER) - Input-like Layout
// =============================================================================

.#{$select-prefix-cls}-selector {
    @include select-selector($select-prefix-cls);
}

// =============================================================================
// SELECTED VALUE DISPLAY
// =============================================================================

.#{$select-prefix-cls}-selection {
    @include select-selection($select-prefix-cls);

    // Override for multi-select to allow wrapping
    .#{$select-prefix-cls}-multiple &,
    .#{$select-prefix-cls}-tags & {
        white-space: normal;
        overflow: visible;
    }
}

// =============================================================================
// MULTI-SELECT TAGS
// =============================================================================

.#{$select-prefix-cls}-selection-overflow {
    display: flex;
    flex: 1;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--nx-space-xs);
    margin: calc(-1 * var(--nx-space-xs)) 0;
    padding: var(--nx-space-xs) 0;
    max-height: 100px;
    overflow-y: auto;
    min-width: 0;

    &::-webkit-scrollbar {
        width: 4px;
    }

    &::-webkit-scrollbar-track {
        background: transparent;
    }

    &::-webkit-scrollbar-thumb {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 2px;
    }
}

// Single select (default mode) - plain text, no tags
.#{$select-prefix-cls}-default {
    .#{$select-prefix-cls}-selection-item {
        display: inline;
        padding: 0;
        margin: 0;
        background: transparent;
        color: $text-color;
        border: none;
        font-size: $font-size-base;
        line-height: $line-height-base;
        font-weight: normal;
    }
}

// Multi-select and tags mode use tag styling - target items inside overflow container
.#{$select-prefix-cls}-multiple .#{$select-prefix-cls}-selection-overflow .#{$select-prefix-cls}-selection-item,
.#{$select-prefix-cls}-tags .#{$select-prefix-cls}-selection-item,
.#{$select-prefix-cls}-selection-overflow.nx-select-tags .#{$select-prefix-cls}-selection-item {
    gap: 0.25rem;
    display: inline-flex !important;
    align-items: center;
    padding: 2px var(--nx-space-xs) !important;
    margin: 0 !important;
    background: var(--nx-select-tag-bg) !important;
    color: var(--nx-select-tag-color) !important;
    border: 1px solid var(--nx-select-tag-border-color) !important;
    border-radius: var(--nx-border-radius-sm) !important;
    font-size: var(--nx-font-size-sm) !important;
    line-height: 1.4 !important;
    user-select: none;
    white-space: nowrap !important;
    height: fit-content;
}

// Remove button in tags
.#{$select-prefix-cls}-multiple .#{$select-prefix-cls}-selection-item-remove,
.#{$select-prefix-cls}-tags .#{$select-prefix-cls}-selection-item-remove,
.#{$select-prefix-cls}-selection-overflow.nx-select-tags .#{$select-prefix-cls}-selection-item-remove {
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    margin-left: var(--nx-space-xss);
    color: var(--nx-select-tag-remove-color);
    cursor: pointer;
    border-radius: 50%;
    transition: background-color var(--nx-animation-duration-fast) var(--nx-easing-out);

    &:hover {
        background-color: rgba(0, 0, 0, 0.1);
    }

    [nx-icon] {
        font-size: 10px;
    }
}

// More tag styling
.#{$select-prefix-cls}-multiple .#{$select-prefix-cls}-selection-item-more,
.#{$select-prefix-cls}-tags .#{$select-prefix-cls}-selection-item-more,
.#{$select-prefix-cls}-selection-overflow.nx-select-tags .#{$select-prefix-cls}-selection-item-more {
    color: var(--nx-select-tag-color);
    background: color-mix(in srgb, var(--nx-select-tag-bg) 10%, transparent);
    border-color: color-mix(in srgb, var(--nx-select-tag-border-color) 20%, transparent);
}

// =============================================================================
// DROPDOWN ARROW
// =============================================================================

.#{$select-prefix-cls}-arrow {
    @include select-arrow($select-prefix-cls);
}

// Loading Spinner (similar to button)
.#{$select-prefix-cls}-spinner {
    display: inline-block;
    width: 14px;
    height: 14px;
    border: 2px solid currentColor;
    border-top-color: transparent;
    border-radius: 50%;
    animation: nxSelectLoadingSpin $animation-duration-slow linear infinite;
}

// =============================================================================
// DROPDOWN CONTAINER
// =============================================================================

.#{$select-prefix-cls}-dropdown {
    @include select-dropdown($select-prefix-cls);
}

// =============================================================================
// DROPDOWN SEARCH
// =============================================================================

.#{$select-prefix-cls}-dropdown-search {
    @include select-search($select-prefix-cls);
}

// =============================================================================
// DROPDOWN LIST
// =============================================================================

.#{$select-prefix-cls}-dropdown-list {
    @include select-dropdown-list($select-prefix-cls);
}

// =============================================================================
// DROPDOWN OPTIONS
// =============================================================================

.#{$select-prefix-cls}-dropdown-item {
    @include select-dropdown-item($select-prefix-cls);
}

.#{$select-prefix-cls}-dropdown-item-content {
    display: flex;
    align-items: center;
    width: 100%;
    overflow: hidden;
}

.#{$select-prefix-cls}-dropdown-item-checkbox {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    margin-right: var(--nx-space-xs);
    border: 1px solid $border-color-base;
    border-radius: 2px;
    background: $component-background;
    transition: all $animation-duration-fast $ease-base-out;

    [nx-icon] {
        font-size: 12px;
        color: $component-background;
    }
}

// Checkbox in selected item
.#{$select-prefix-cls}-dropdown-item-selected {
    .#{$select-prefix-cls}-dropdown-item-checkbox {
        background: $component-background;
        border-color: $component-background;

        [nx-icon] {
            color: $primary-color;
        }
    }
}

// Checkbox in hovered item
.#{$select-prefix-cls}-dropdown-item:hover,
.#{$select-prefix-cls}-dropdown-item-active {
    .#{$select-prefix-cls}-dropdown-item-checkbox {
        border-color: $component-background;

        [nx-icon] {
            color: $component-background;
        }
    }
}

.#{$select-prefix-cls}-dropdown-item-label {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

// =============================================================================
// DROPDOWN EMPTY STATE
// =============================================================================

.#{$select-prefix-cls}-dropdown-empty {
    @include select-empty($select-prefix-cls);
}

// =============================================================================
// VIRTUAL SCROLLING
// =============================================================================

.#{$select-prefix-cls}-virtual-scroll-container {
    position: relative;
    width: 100%;
    overflow: hidden;
}

// =============================================================================
// HIGHLIGHT TEXT (SEARCH MATCH)
// =============================================================================

mark {
    background: rgba($warning-color, 0.2);
    color: inherit;
    padding: 0;
    border-radius: 2px;
}

// =============================================================================
// RESPONSIVE DESIGN
// =============================================================================

@include select-mobile($select-prefix-cls);

// =============================================================================
// ACCESSIBILITY IMPROVEMENTS
// =============================================================================

@include select-reduced-motion($select-prefix-cls);
@include select-high-contrast($select-prefix-cls);
